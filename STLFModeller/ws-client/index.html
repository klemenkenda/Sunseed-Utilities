<!DOCTYPE html>
<html>
  <head>
    <script
      src="https://code.jquery.com/jquery-3.1.1.min.js"
      integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
      crossorigin="anonymous"></script>    
    <script src="http://code.highcharts.com/highcharts.js"></script>	
    <script src="https://cdnjs.cloudflare.com/ajax/libs/deepstream.io-client-js/2.1.1/deepstream.js"></script>
  </head>
  <body>
    <script type="text/javascript">
	var client = deepstream('sunseed-analytics.ijs.si:6020').login();
	client.event.subscribe('example', eventCallback);

	var chart; // global

	function eventCallback(dataStr) {
    		// console.log(data);            

	    
	    data = JSON.parse(dataStr);
            var unixts = 10 * 365 * 24 * 60 * 60 * 1000 + (data["week_id"] + 1) * 7 * 24 * 60 * 60 * 1000 + data["sec_id"] * 1000 + data["report_n"] * 20;  

	    var pointv1 = [ unixts, data["v1"] ];
	    var pointv2 = [ unixts, data["v2"] ];
	    var pointv3 = [ unixts, data["v3"] ];
	
	    console.log(pointv1);
            var series = chart.series[0],
                shift = series.data.length > 40; // shift if the series is 
                                                 // longer than 20

            // add the point
            chart.series[0].addPoint(pointv1, true, shift);
	   
            // series 2
	    var series2 = chart.series[1],
                shift2 = series2.data.length > 40;
	    chart.series[1].addPoint(pointv2, true, shift2);
	    
	    // series 3
  	    var series3 = chart.series[2],
                shift3 = series3.data.length > 40;
            chart.series[2].addPoint(pointv3, true, shift3);
	}

	
	$(document).ready(function() {
	    chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
            type: 'scatter',
	    //defaultSeriesType: 'spline',
            events: {
                // load: requestData
            }
        },
        title: {
            text: 'Live data from WAMS'
        },
        xAxis: {
            type: 'datetime',
            tickPixelInterval: 150,
            maxZoom: 20 * 1000
        },
        yAxis: {
            minPadding: 0.2,
            maxPadding: 0.2,
            title: {
                text: 'Value',
                margin: 80
            }
        },
        series: [{
            name: 'V1',
            data: []
        },
	{
	    name: 'V2',
	    data: []
	},
	{
	    name: 'V3',
	    data: []
	}]
    });        
});

    </script>
    <div id="container" style="width:100%; height:400px;"></div>
  </body>
</html>
